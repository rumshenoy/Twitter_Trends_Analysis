<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Project</title>
<link rel="stylesheet" type="text/css" href="style2.css" media="screen" />
</head>
<body>
<script type="text/javascript" src="http://www.google.com/jsapi"></script>
<script type="text/javascript">
// Load jQuery
google.load("jquery", "1.3");
</script>
<div id="header">
<h1>Twitter TrendsMap</h1>
<h1>City Trends</h1>
 <div id="menu">
  <ul id="nav">
   <li><a href="http://localhost:80/proj/index.html">Home</a></li>
   <li><a href="http://localhost:80/proj/country.html">Country Trends</a></li>
   <li><a href="http://localhost:80/proj/city.html">City Trends</a></li>
   <li><a href="http://localhost:80/cgi-bin/form.py">Inputs</a></li>
  </ul>
 </div>
</div>
<div id="content">
<div id="right">
 <div id="menu">
<style type="text/css">
ul#nav2,ul#nav li{list-style-type:none;margin:0;padding:0}
ul#nav2{float:left;font-size: 90%}
ul#nav2 li{float:left;margin-left: 3px;text-align: center}
ul#nav2 a{float:left;width: 95px;padding: 5px 0;background: #E7F1F8;text-decoration:none;color: #666; border-top : 1px solid #fff; border-left : 1px solid #fff; border-right : 1px solid #fff;}
ul#nav2 a:hover{background: #fff;color: #000}
ul#nav2 li.activelink a,ul#nav2 li.activelink a:hover{background: #FFF;color: #003}
</style>
  <ul id="nav2">
   <li><div><a href="javascript:getTrendsLink()">Top 10 Trends</a>
        </li>
   <li><a href="javascript:drawChart()">Graphs</a></li>
  </ul>
</div>
<div id="content">
<div class="box">
			<div id = "tabcontent"><h3>Click on a city to see more!</h3>


			</div>
			
			
	</div>

</div>
</div>

	
<div id="left">
			
	<!--<div class="box">
				
				<ul>
				<li><a href="http://localhost:80/proj/city.html">Bangalore</a></li>
				<li><a href="http://localhost:80/proj/delhi.html">Delhi</a></li>
				<li><a href="http://localhost:80/proj/kolkata.html">Kolkata</a></li>
				<li><a href="http://localhost:80/proj/mumbai.html">Mumbai</a></li>
				</ul>
	</div>-->

		<div class="box">
				
				<ul>
				<li><a href="javascript:setWoeid(12586571)">Bangalore</a></li>
				<li><a href="javascript:setWoeid(20070458)">Delhi</a></li>
				<li><a href="javascript:setWoeid(12586539)">Mumbai</a></li>
				<li><a href="javascript:setWoeid(12586798)">kolkata</a></li>
	
				</ul>
	</div>
		
		
    
</div>
</div>

<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js" type="text/javascript"></script>
<script src="showHide.js" type="text/javascript"></script>
<script type="text/javascript">
google.load("jquery", "1.3");
var woeid = null;
var trendslinks = null;
var trendarray= null;
var sD= null;
var int;
function change(ltweets,k,ldiv)
	{	
	var x = document.getElementById(ldiv);	
	var y= x.childNodes[0];
	if(y!= null){
	var mytext=document.createTextNode(ltweets[k]);
	x.replaceChild(mytext,y);
	}
	else		
	{var mytext=document.createTextNode(ltweets[k]);
	x.appendChild(mytext);
	}
	
	k++;
	
	int = self.setTimeout(function() {
    	change(ltweets,k,ldiv);
	}, 2000);
	

	
	}
function setWoeid(id){

	window.woeid = id;
	getTrendsLink();
	

}

function ReplaceContentInContainer(id,content) {
var container = document.getElementById(id);
container.innerHTML = content;
}

function getTrendData(){
jQuery.ajaxSetup({async:false});
trends = new Array();

$.get("demo.php?woeid="+woeid, function(data){
trends = JSON.parse(data);

});
}
function getTrendsLink(){

	getTrendData();
	var x = document.getElementById("tabcontent");
	var newlink = document.createElement('div');
	

	
	
	
for(i=0;i<trends.length;i++){

	var a = document.createElement('a');
	a.title = trends[i][0];
	a.innerHTML = "<br>"+a.title;
	a.href = "#";
	a.className = "show_hide";
	a.rel = "#slidingDiv_"+i;

	newlink.appendChild(a);

	var slide = document.createElement('div');
	slide.id = "slidingDiv_"+i;
	//slide.className = "toggleDiv";
	newlink.appendChild(slide);
	
	/*a.onclick = function() { return function() { 
	alert(a.rel);
	var k =0;
	$.get("getTweets.php",{value:a.title}, function(data){
	tweets = JSON.parse(data);
	});
	//int=window.clearInterval(int)
	//change(tweets,k);
	
	

	 }; }(i);*/

	
	
	

}
	$('#tabcontent').empty().append(newlink);
	$(document).ready(function(){
		jQuery('a').click(function() {

			var val = this.title;
			var ldiv = this.rel;
			ldiv = ldiv.replace('#','');
			$.get("getTweets.php?value="+val, function(data){
	ltweets = JSON.parse(data);
	var k =0;
	int=window.clearInterval(int)
	change(ltweets,k,ldiv);
	});
                }); 		

   $('.show_hide').showHide({
        speed: 1000,  // speed you want the toggle to happen
        easing: '',  // the animation effect you want. Remove this line if you dont want an effect and if you haven't included jQuery UI
        changeText: 1, // if you dont want the button text to change, set this to 0
        //showText: ,// the button text to show when a div is closed
       // hideText: ;  // the button text to show when a div is open
 	
    });
});

}



google.load("visualization", "1", {packages:["corechart"]});
      //google.setOnLoadCallback(drawChart);
	var trends;
	var freq;
	

	
	//jQuery.ajaxSetup({async:false});
    	
	//rendarray = new Array();
	// $.get("graph.php",{woeid:12586571}, function(data){
	//trendarray = JSON.parse(data);
	

	
//})


function drawChart() {
	
	
       // var data = google.visualization.arrayToDataTable(trendarray);
	
        var options = {
          title: 'Trends vs Frequency'
        };
	
	var jsonData = $.ajax({
        url: "graph.php?woeid="+woeid,
        dataType:"json",
        async: false,
	method:"POST"
    	}).responseText;

	
	trendarray = JSON.parse(jsonData);
	
	var data = google.visualization.arrayToDataTable(trendarray);

	//var x = document.getElementById("tabcontent");
	$('#tabcontent').empty().append('<div id="chart_div" style="width: 650px; height: 500px;"></div>');
	
	//<div id="chart_div" style="width: 650px; height: 500px;"></div>
        var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
        chart.draw(data, options);
	
}



</script>

</body>
</html>
